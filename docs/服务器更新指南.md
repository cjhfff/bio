# æœåŠ¡å™¨ä»£ç æ›´æ–°æŒ‡å—

## ðŸ“‹ æ›´æ–°å‰å‡†å¤‡

### 1. æ£€æŸ¥ Python ç‰ˆæœ¬

åœ¨æ›´æ–°ä»£ç å‰ï¼Œå…ˆæ£€æŸ¥æœåŠ¡å™¨ä¸Šçš„ Python ç‰ˆæœ¬ï¼š

```bash
# æ–¹æ³•1: ä½¿ç”¨æ£€æµ‹è„šæœ¬ï¼ˆæŽ¨èï¼‰
bash scripts/check_python.sh

# æ–¹æ³•2: æ‰‹åŠ¨æ£€æŸ¥
python3.9 --version
python3 --version
python --version

# æ–¹æ³•3: æŸ¥çœ‹æ‰€æœ‰ Python ç‰ˆæœ¬
which -a python3
ls -la /usr/bin/python*
```

### 2. å¤‡ä»½é‡è¦æ•°æ®

```bash
# å¤‡ä»½æ•°æ®åº“
cp data/database/paper_push.db data/database/paper_push.db.backup.$(date +%Y%m%d_%H%M%S)

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp .env .env.backup.$(date +%Y%m%d_%H%M%S)
cp data/keywords.json data/keywords.json.backup.$(date +%Y%m%d_%H%M%S) 2>/dev/null || true
```

## ðŸš€ æ›´æ–°æ­¥éª¤

### æ–¹æ³•1: ä½¿ç”¨é‡å¯è„šæœ¬ï¼ˆæŽ¨èï¼‰

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/bio

# 2. åœæ­¢æœåŠ¡
bash scripts/stop.sh

# 3. æ›´æ–°ä»£ç ï¼ˆé€šè¿‡ git æˆ–å…¶ä»–æ–¹å¼ï¼‰
# git pull  # å¦‚æžœæœ‰ä½¿ç”¨ git
# æˆ–ç›´æŽ¥ä¸Šä¼ æ–°ä»£ç 

# 4. æ£€æŸ¥ Python ç‰ˆæœ¬ï¼ˆå¦‚æžœéœ€è¦ï¼‰
bash scripts/check_python.sh

# 5. å¦‚æžœæœåŠ¡å™¨æ˜¯ Python 3.9ï¼Œè®¾ç½®çŽ¯å¢ƒå˜é‡
export PYTHON_EXEC="python3.9"

# 6. å®‰è£…/æ›´æ–°ä¾èµ–
$PYTHON_EXEC -m pip install -r requirements.txt

# 7. å¯åŠ¨æœåŠ¡
bash scripts/start.sh
```

### æ–¹æ³•2: ä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆå®Œæ•´æ›´æ–°ï¼‰

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/bio

# 2. è®¾ç½® Python ç‰ˆæœ¬ï¼ˆå¦‚æžœæœåŠ¡å™¨æ˜¯ Python 3.9ï¼‰
export PYTHON_EXEC="python3.9"

# 3. è¿è¡Œéƒ¨ç½²è„šæœ¬ï¼ˆä¼šè‡ªåŠ¨åœæ­¢æ—§è¿›ç¨‹ã€æ›´æ–°ä¾èµ–ã€å¯åŠ¨æœåŠ¡ï¼‰
bash scripts/deploy.sh
```

### æ–¹æ³•3: æ‰‹åŠ¨æ›´æ–°

```bash
# 1. åœæ­¢æœåŠ¡
bash scripts/stop.sh

# 2. æ›´æ–°ä»£ç 
# ï¼ˆä¸Šä¼ æ–°æ–‡ä»¶æˆ– git pullï¼‰

# 3. æ£€æŸ¥ Python ç‰ˆæœ¬
bash scripts/check_python.sh

# 4. è®¾ç½® Python å‘½ä»¤ï¼ˆæ ¹æ®æ£€æµ‹ç»“æžœï¼‰
export PYTHON_EXEC="python3.9"  # æˆ– python3, python

# 5. æ›´æ–°ä¾èµ–
$PYTHON_EXEC -m pip install -r requirements.txt

# 6. éªŒè¯ä»£ç 
$PYTHON_EXEC -c "import os; os.environ['DB_PATH']='data/database/paper_push.db'; from backend.api.main import app; print('ä»£ç éªŒè¯é€šè¿‡')"

# 7. å¯åŠ¨æœåŠ¡
bash scripts/start.sh

# 8. æ£€æŸ¥çŠ¶æ€
bash scripts/check_status.sh
```

## âš™ï¸ Python ç‰ˆæœ¬é…ç½®

### è‡ªåŠ¨æ£€æµ‹ï¼ˆæŽ¨èï¼‰

è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹å¯ç”¨çš„ Python ç‰ˆæœ¬ï¼Œä¼˜å…ˆçº§ï¼š
1. `python3.9`ï¼ˆå¦‚æžœå­˜åœ¨ï¼‰
2. `python3`ï¼ˆå¦‚æžœå­˜åœ¨ï¼‰
3. `python`ï¼ˆå¦‚æžœå­˜åœ¨ï¼‰

### æ‰‹åŠ¨æŒ‡å®š

å¦‚æžœè‡ªåŠ¨æ£€æµ‹ä¸å‡†ç¡®ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼š

```bash
# ä¸´æ—¶æŒ‡å®šï¼ˆå½“å‰ä¼šè¯æœ‰æ•ˆï¼‰
export PYTHON_EXEC="python3.9"
bash scripts/start.sh

# æˆ–åœ¨è„šæœ¬ä¸­ç›´æŽ¥ä¿®æ”¹
# ç¼–è¾‘ scripts/start.shï¼Œä¿®æ”¹ PYTHON_EXEC å˜é‡
```

### æ°¸ä¹…é…ç½®

åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºé…ç½®æ–‡ä»¶ï¼š

```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > ~/.bio_python_config << EOF
export PYTHON_EXEC="python3.9"
EOF

# æ¯æ¬¡ä½¿ç”¨å‰åŠ è½½
source ~/.bio_python_config
bash scripts/start.sh
```

## âœ… éªŒè¯æ›´æ–°

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
bash scripts/check_status.sh
```

### 2. æ£€æŸ¥å¥åº·æŽ¥å£

```bash
curl http://127.0.0.1:8000/health
# åº”è¯¥è¿”å›ž: {"status":"healthy"}
```

### 3. æ£€æŸ¥ API æ–‡æ¡£

```bash
# åœ¨æµè§ˆå™¨è®¿é—®
http://æœåŠ¡å™¨IP:8000/docs
```

### 4. æŸ¥çœ‹æ—¥å¿—

```bash
# å®žæ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/api.log

# æŸ¥çœ‹æœ€åŽ 50 è¡Œ
tail -50 logs/api.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep -i error logs/api.log | tail -20
```

## ðŸ”§ å¸¸è§é—®é¢˜

### é—®é¢˜1: Python ç‰ˆæœ¬ä¸åŒ¹é…

**ç—‡çŠ¶**: `ModuleNotFoundError` æˆ– `SyntaxError`

**è§£å†³**:
```bash
# 1. æ£€æµ‹æœåŠ¡å™¨ Python ç‰ˆæœ¬
bash scripts/check_python.sh

# 2. è®¾ç½®æ­£ç¡®çš„ Python ç‰ˆæœ¬
export PYTHON_EXEC="python3.9"  # æ ¹æ®å®žé™…æƒ…å†µè°ƒæ•´

# 3. é‡æ–°å®‰è£…ä¾èµ–
$PYTHON_EXEC -m pip install -r requirements.txt

# 4. é‡å¯æœåŠ¡
bash scripts/restart.sh
```

### é—®é¢˜2: ä¾èµ–å®‰è£…å¤±è´¥

**è§£å†³**:
```bash
# å‡çº§ pip
$PYTHON_EXEC -m pip install --upgrade pip

# å•ç‹¬å®‰è£…å¤±è´¥çš„åŒ…
$PYTHON_EXEC -m pip install åŒ…å

# æˆ–ä½¿ç”¨å›½å†…é•œåƒ
$PYTHON_EXEC -m pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### é—®é¢˜3: ç«¯å£è¢«å ç”¨

**è§£å†³**:
```bash
# æŸ¥çœ‹å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i:8000

# æˆ–ä½¿ç”¨è„šæœ¬åœæ­¢
bash scripts/stop.sh
```

### é—®é¢˜4: æ•°æ®åº“è¿ç§»é—®é¢˜

**è§£å†³**:
```bash
# æ•°æ®åº“ä¼šè‡ªåŠ¨è¿ç§»ï¼Œä½†å¦‚æžœé‡åˆ°é—®é¢˜ï¼š
# 1. å¤‡ä»½æ•°æ®åº“
cp data/database/paper_push.db data/database/paper_push.db.backup

# 2. æ£€æŸ¥æ•°æ®åº“ç»“æž„
sqlite3 data/database/paper_push.db ".schema"

# 3. é‡å¯æœåŠ¡ï¼ˆä¼šè‡ªåŠ¨è¿è¡Œ init_dbï¼‰
bash scripts/restart.sh
```

## ðŸ“ æ›´æ–°æ£€æŸ¥æ¸…å•

- [ ] å¤‡ä»½æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶
- [ ] æ£€æŸ¥ Python ç‰ˆæœ¬å…¼å®¹æ€§
- [ ] åœæ­¢æ—§æœåŠ¡
- [ ] æ›´æ–°ä»£ç æ–‡ä»¶
- [ ] æ›´æ–°ä¾èµ–åŒ…
- [ ] éªŒè¯ä»£ç å¯åŠ è½½
- [ ] å¯åŠ¨æ–°æœåŠ¡
- [ ] æ£€æŸ¥æœåŠ¡çŠ¶æ€
- [ ] æµ‹è¯• API æŽ¥å£
- [ ] æŸ¥çœ‹æ—¥å¿—ç¡®è®¤æ— é”™è¯¯

## ðŸ”„ å¿«é€Ÿé‡å¯å‘½ä»¤

```bash
# ä¸€é”®é‡å¯ï¼ˆæŽ¨èï¼‰
bash scripts/restart.sh

# æˆ–åˆ†æ­¥æ‰§è¡Œ
bash scripts/stop.sh && sleep 2 && bash scripts/start.sh
```

## ðŸ“ž èŽ·å–å¸®åŠ©

å¦‚æžœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æ—¥å¿—: `tail -f logs/api.log`
2. æ£€æŸ¥çŠ¶æ€: `bash scripts/check_status.sh`
3. æ£€æŸ¥ Python: `bash scripts/check_python.sh`
4. æŸ¥çœ‹è¿›ç¨‹: `ps aux | grep uvicorn`
