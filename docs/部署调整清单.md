# éƒ¨ç½²åˆ°æœåŠ¡å™¨éœ€è¦è°ƒæ•´çš„é…ç½®æ¸…å•

## âœ… å·²è‡ªåŠ¨å¤„ç†çš„é…ç½®

### 1. è·¯å¾„é…ç½®
- âœ… **æ•°æ®åº“è·¯å¾„**ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„ `data/paper_push.db`ï¼Œè‡ªåŠ¨åˆ›å»ºç›®å½•
- âœ… **æ—¥å¿—è·¯å¾„**ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„ `logs/`ï¼Œè‡ªåŠ¨åˆ›å»ºç›®å½•
- âœ… **æŠ¥å‘Šè·¯å¾„**ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„ `reports/`ï¼Œ**å·²ä¿®å¤**è‡ªåŠ¨åˆ›å»ºç›®å½•
- âœ… **è·¯å¾„åˆ†éš”ç¬¦**ï¼šä½¿ç”¨ `pathlib.Path`ï¼Œè‡ªåŠ¨é€‚é… Windows/Linux

### 2. ç¼–ç å¤„ç†
- âœ… æ‰€æœ‰æ–‡ä»¶æ“ä½œä½¿ç”¨ `encoding='utf-8'`
- âœ… Windows æ§åˆ¶å°ç¼–ç è‡ªåŠ¨ä¿®å¤

### 3. æ•°æ®åº“åˆå§‹åŒ–
- âœ… æ•°æ®åº“è¡¨ç»“æ„è‡ªåŠ¨åˆ›å»º
- âœ… æ”¯æŒ WAL æ¨¡å¼ï¼Œå¹¶å‘å®‰å…¨

## âš ï¸ éœ€è¦æ‰‹åŠ¨è°ƒæ•´çš„é…ç½®

### 1. ä»£ç†è®¾ç½®ï¼ˆé‡è¦ï¼‰

**å½“å‰çŠ¶æ€**ï¼šä»£ç å¼ºåˆ¶æ¸…é™¤æ‰€æœ‰ä»£ç†è®¾ç½®

**å½±å“**ï¼šå¦‚æœæœåŠ¡å™¨éœ€è¦é€šè¿‡ä»£ç†è®¿é—®å¤–ç½‘ï¼Œéœ€è¦ä¿®æ”¹ä»£ç 

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**ï¼š
1. `app/cli.py` (ç¬¬6-11è¡Œ)
2. `app/sources/github.py` (ç¬¬73è¡Œ)
3. `app/sources/europepmc.py` (ç¬¬42è¡Œ)
4. `app/sources/biorxiv.py` (ç¬¬61è¡Œ)
5. `app/sources/pubmed.py` (å¤šå¤„)
6. `app/sources/sciencenews.py` (ç¬¬54è¡Œ)
7. `app/sources/semanticscholar.py` (ç¬¬67è¡Œ)
8. `app/sources/rss.py` (ç¬¬105è¡Œ)
9. `app/push/pushplus.py` (ç¬¬36è¡Œ)

**è°ƒæ•´æ–¹æ¡ˆ**ï¼ˆäºŒé€‰ä¸€ï¼‰ï¼š

#### æ–¹æ¡ˆAï¼šä¿®æ”¹ä»£ç æ”¯æŒä»£ç†é…ç½®ï¼ˆæ¨èï¼‰

åœ¨ `app/config.py` ä¸­æ·»åŠ ï¼š
```python
# ä»£ç†é…ç½®
HTTP_PROXY = os.getenv("HTTP_PROXY", "")
HTTPS_PROXY = os.getenv("HTTPS_PROXY", "")
USE_PROXY = os.getenv("USE_PROXY", "false").lower() == "true"
```

ä¿®æ”¹æ‰€æœ‰ `proxies={'http': None, 'https': None}` ä¸ºï¼š
```python
if Config.USE_PROXY and Config.HTTP_PROXY:
    proxies = {
        'http': Config.HTTP_PROXY,
        'https': Config.HTTPS_PROXY or Config.HTTP_PROXY
    }
else:
    proxies = {'http': None, 'https': None}
```

åœ¨ `.env` ä¸­æ·»åŠ ï¼š
```bash
USE_PROXY=true
HTTP_PROXY=http://proxy.example.com:8080
HTTPS_PROXY=http://proxy.example.com:8080
```

#### æ–¹æ¡ˆBï¼šç§»é™¤ä»£ç†æ¸…é™¤é€»è¾‘ï¼ˆç®€å•ï¼‰

å¦‚æœæœåŠ¡å™¨å·²é…ç½®ç³»ç»Ÿä»£ç†ï¼Œç›´æ¥åˆ é™¤ä»£ç ä¸­çš„ï¼š
- `app/cli.py` ä¸­çš„ `os.environ.pop('http_proxy', None)` ç­‰
- æ‰€æœ‰ `proxies={'http': None, 'https': None}` æ”¹ä¸ºä¸è®¾ç½® `proxies` å‚æ•°

### 2. ç¯å¢ƒå˜é‡é…ç½®

**å¿…éœ€é…ç½®**ï¼ˆ`.env` æ–‡ä»¶ï¼‰ï¼š
```bash
DEEPSEEK_API_KEY=sk-xxx
PUBMED_EMAIL=your-email@example.com
```

**å¯é€‰é…ç½®**ï¼š
```bash
# æ¨é€æ¸ é“
PUSHPLUS_TOKENS=token1,token2
EMAIL_SMTP_HOST=smtp.example.com
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=your-email@example.com
EMAIL_SMTP_PASSWORD=your-password
EMAIL_TO=recipient@example.com
WECOM_WEBHOOK_URL=https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx

# è·¯å¾„é…ç½®ï¼ˆå¯é€‰ï¼‰
DB_PATH=data/paper_push.db
LOG_FILE=paper_push.log

# è¿è¡Œå‚æ•°ï¼ˆå¯é€‰ï¼‰
DEFAULT_WINDOW_DAYS=1
EUROPEPMC_WINDOW_DAYS=1
QUICK_FILTER_THRESHOLD=50
API_TIMEOUT=600
```

### 3. å®šæ—¶ä»»åŠ¡é…ç½®

**Windows**ï¼šä½¿ç”¨ `run_daily.bat` + ä»»åŠ¡è®¡åˆ’ç¨‹åº

**Linux**ï¼š
- **Crontab**ï¼š`30 8 * * * cd /path/to/bio && /path/to/venv/bin/python -m app run`
- **Systemd**ï¼šå‚è€ƒ `docs/æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—.md`

### 4. æ–‡ä»¶æƒé™

```bash
# ç¡®ä¿ç›®å½•å¯å†™
chmod 755 data logs reports

# ä¿æŠ¤é…ç½®æ–‡ä»¶
chmod 600 .env

# ç¡®ä¿è¿è¡Œç”¨æˆ·æœ‰æƒé™
chown -R your-user:your-group data logs reports
```

### 5. ç³»ç»Ÿ Localeï¼ˆä¸­æ–‡æ”¯æŒï¼‰

```bash
# è®¾ç½®ç³»ç»Ÿ locale
export LANG=zh_CN.UTF-8
export LC_ALL=zh_CN.UTF-8

# æˆ–åœ¨ crontab/systemd ä¸­è®¾ç½®
```

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

ä½¿ç”¨ `scripts/check_deployment.py` æ£€æŸ¥ï¼š

```bash
python scripts/check_deployment.py
```

æ£€æŸ¥é¡¹åŒ…æ‹¬ï¼š
- âœ… Python ç‰ˆæœ¬ (3.8+)
- âœ… ä¾èµ–åŒ…å®‰è£…
- âœ… ç›®å½•ç»“æ„
- âœ… ç¯å¢ƒé…ç½®
- âœ… æ•°æ®åº“
- âœ… ç½‘ç»œè¿æ¥
- âœ… ä»£ç†è®¾ç½®

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

ä½¿ç”¨ `scripts/deploy_server.sh`ï¼š

```bash
chmod +x scripts/deploy_server.sh
./scripts/deploy_server.sh /path/to/bio
```

## ğŸ“ è¯¦ç»†æ–‡æ¡£

å®Œæ•´éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒï¼š`docs/æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—.md`

