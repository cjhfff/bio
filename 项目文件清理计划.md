# 项目文件清理和优化计划

## 一、项目文件审查

### 1. 测试文件（需要整理）

#### 应该保留的测试文件（在 tests/ 目录下）
- ✅ `tests/test_batch_processing.py` - 批处理功能测试
- ✅ `tests/test_api_connection.py` - API连接测试
- ✅ `tests/test_cli_batch_logic.py` - CLI逻辑测试
- ✅ `tests/test_deduplication.py` - 去重功能测试
- ✅ `tests/test_rss_doi_extraction.py` - RSS DOI提取测试
- ✅ `tests/run_tests.py` - 测试运行脚本
- ✅ `tests/README.md` - 测试文档

#### 应该移除的临时测试文件（在根目录）
- ❌ `test_ui.py` - 临时UI测试（已过时）
- ❌ `test_deepseek_api.py` - 临时API测试（功能已集成）
- ❌ `test_deepseek_connection.py` - 临时连接测试（功能已集成）
- ❌ `test_optimizations.py` - 临时优化测试（已过时）
- ❌ `test_full_optimization.py` - 临时优化测试（已过时）
- ❌ `test_scoring_synergy.py` - 临时评分测试（已过时）
- ❌ `test_sources_detail.py` - 临时数据源测试（已过时）
- ❌ `test_differential_filtering.py` - 临时过滤测试（已过时）
- ❌ `test_date_today.py` - 临时日期测试（已过时）
- ❌ `test_optimization_verify.py` - 临时验证测试（已过时）
- ❌ `test_optimization.py` - 临时优化测试（已过时）
- ❌ `test_sources_now.py` - 临时数据源测试（已过时）
- ❌ `test_paper_verification.py` - 临时论文验证（已过时）
- ❌ `test_paper_dates.py` - 临时日期测试（已过时）

### 2. 诊断和检查脚本（需要整理）

#### 应该保留的工具脚本（建议移到 scripts/ 目录）
- `diagnose_llm.py` - LLM诊断工具
- `clear_database.py` - 数据库清理工具
- `migrate_legacy_data.py` - 数据迁移工具

#### 应该移除的临时检查脚本
- ❌ `analyze_push_issue.py` - 临时分析脚本
- ❌ `analyze_token_usage.py` - 临时分析脚本
- ❌ `check_all_runs_push.py` - 临时检查脚本
- ❌ `check_current_logic.py` - 临时检查脚本
- ❌ `check_database_content.py` - 临时检查脚本
- ❌ `check_duplicate_papers_in_run.py` - 临时检查脚本
- ❌ `check_push_details.py` - 临时检查脚本
- ❌ `check_push_logic_detail.py` - 临时检查脚本
- ❌ `check_push_logic.py` - 临时检查脚本
- ❌ `check_pushes_table.py` - 临时检查脚本
- ❌ `check_task_status.py` - 临时检查脚本
- ❌ `show_ai_input.py` - 临时展示脚本
- ❌ `show_paper_format.py` - 临时展示脚本

### 3. 文档文件（需要整理）

#### 应该保留的文档
- ✅ `README.md` - 项目说明
- ✅ `README_定时任务设置.md` - 定时任务设置说明
- ✅ `deploy_to_server.md` - 部署文档
- ✅ `requirements.txt` - 依赖列表
- ✅ `优化和测试总结.md` - 优化总结

#### 应该移除或归档的文档
- ❌ `cleanup_plan.md` - 清理计划（已过时）
- ❌ `OPTIMIZATION_REPORT.md` - 优化报告（已过时）
- ❌ `项目完整性评估.md` - 评估文档（已过时）
- ❌ `analyze_run_result.md` - 临时分析文档

### 4. 数据文件（需要清理）

#### 应该保留的数据文件
- ✅ `paper_push.db` - 数据库文件
- ✅ `生化领域突破汇总_*.txt` - 生成的报告（最近7天）

#### 应该移除的数据文件
- ❌ `sent_list.txt` - 旧的已推送列表（已被数据库替代）
- ❌ `sent_meta.jsonl` - 旧的元数据（已被数据库替代）
- ❌ `paper_push_server.zip` - 旧的服务器包（已过时）

### 5. 配置和脚本文件

#### 应该保留的
- ✅ `run_daily.bat` - Windows定时任务脚本
- ✅ `setup_scheduled_task.ps1` - PowerShell设置脚本
- ✅ `setup_server.sh` - Linux服务器设置脚本
- ✅ `快速设置定时任务.txt` - 快速设置指南

#### 应该移除的
- ❌ `doubao_standalone.py` - 旧的独立脚本（已被主程序替代）

## 二、建议的项目结构

```
bio/
├── app/                    # 主程序代码
│   ├── sources/           # 数据源模块
│   ├── storage/           # 数据库模块
│   ├── llm/               # AI报告生成模块
│   ├── push/              # 推送模块
│   └── ...
├── tests/                  # 测试代码
│   ├── test_*.py          # 测试文件
│   ├── run_tests.py       # 测试运行脚本
│   └── README.md          # 测试文档
├── scripts/                # 工具脚本（新建）
│   ├── diagnose_llm.py    # LLM诊断
│   ├── clear_database.py  # 数据库清理
│   └── migrate_legacy_data.py  # 数据迁移
├── logs/                   # 日志文件
├── docs/                   # 文档（新建，归档旧文档）
│   ├── README.md          # 主文档
│   ├── deploy.md          # 部署文档
│   ├── optimization.md    # 优化文档
│   └── archived/          # 归档的旧文档
├── data/                   # 数据文件（新建）
│   └── paper_push.db      # 数据库
├── reports/                # 生成的报告（新建）
│   └── 生化领域突破汇总_*.txt
├── requirements.txt        # 依赖列表
├── run_daily.bat          # Windows定时任务
├── setup_scheduled_task.ps1  # PowerShell设置
└── setup_server.sh        # Linux服务器设置
```

## 三、清理操作清单

### 1. 创建新目录
```bash
mkdir scripts
mkdir docs
mkdir docs/archived
mkdir data
mkdir reports
```

### 2. 移动文件

#### 移动测试文件（已完成，在 tests/ 目录）
- 无需操作

#### 移动工具脚本到 scripts/
```bash
move diagnose_llm.py scripts/
move clear_database.py scripts/
move migrate_legacy_data.py scripts/
```

#### 移动文档到 docs/
```bash
move README_定时任务设置.md docs/
move deploy_to_server.md docs/deploy.md
move 优化和测试总结.md docs/optimization.md
```

#### 归档旧文档到 docs/archived/
```bash
move cleanup_plan.md docs/archived/
move OPTIMIZATION_REPORT.md docs/archived/
move 项目完整性评估.md docs/archived/
move analyze_run_result.md docs/archived/
```

#### 移动数据文件到 data/
```bash
move paper_push.db data/
```

#### 移动报告文件到 reports/
```bash
move 生化领域突破汇总_*.txt reports/
```

### 3. 删除临时文件

#### 删除临时测试文件
```bash
del test_ui.py
del test_deepseek_api.py
del test_deepseek_connection.py
del test_optimizations.py
del test_full_optimization.py
del test_scoring_synergy.py
del test_sources_detail.py
del test_differential_filtering.py
del test_date_today.py
del test_optimization_verify.py
del test_optimization.py
del test_sources_now.py
del test_paper_verification.py
del test_paper_dates.py
```

#### 删除临时检查脚本
```bash
del analyze_push_issue.py
del analyze_token_usage.py
del check_all_runs_push.py
del check_current_logic.py
del check_database_content.py
del check_duplicate_papers_in_run.py
del check_push_details.py
del check_push_logic_detail.py
del check_push_logic.py
del check_pushes_table.py
del check_task_status.py
del show_ai_input.py
del show_paper_format.py
```

#### 删除旧数据文件
```bash
del sent_list.txt
del sent_meta.jsonl
del paper_push_server.zip
del doubao_standalone.py
```

### 4. 更新配置文件

#### 更新 app/config.py 中的路径
```python
DB_PATH = os.getenv("DB_PATH", "data/paper_push.db")  # 改为 data/ 目录
```

#### 更新 app/cli.py 中的报告保存路径
```python
filename = f"reports/生化领域突破汇总_{today}.txt"  # 改为 reports/ 目录
```

## 四、优先级

### 高优先级（立即执行）
1. 删除所有临时测试文件和检查脚本（约30个文件）
2. 删除旧数据文件（sent_list.txt, sent_meta.jsonl等）

### 中优先级（建议执行）
3. 创建新目录结构（scripts/, docs/, data/, reports/）
4. 移动文件到新目录
5. 更新配置文件中的路径

### 低优先级（可选）
6. 归档旧文档到 docs/archived/
7. 整理 logs/ 目录（删除旧日志）

## 五、清理后的项目结构

清理后，项目根目录应该只包含：
- `app/` - 主程序代码
- `tests/` - 测试代码
- `scripts/` - 工具脚本
- `docs/` - 文档
- `data/` - 数据文件
- `reports/` - 生成的报告
- `logs/` - 日志文件
- `requirements.txt` - 依赖列表
- `run_daily.bat` - Windows定时任务
- `setup_scheduled_task.ps1` - PowerShell设置
- `setup_server.sh` - Linux服务器设置
- `快速设置定时任务.txt` - 快速设置指南

## 六、执行建议

由于文件较多，建议分步执行：
1. 先备份整个项目
2. 删除临时文件
3. 创建新目录
4. 移动文件
5. 更新配置
6. 测试运行

需要我执行这些清理操作吗？

